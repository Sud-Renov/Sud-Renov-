<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8">
<title>–ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –¥–µ–Ω—å</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background:#0f172a;
    color:#f8fafc;
    margin:0;
    padding:20px;
    display:flex;
    flex-direction:column;
    align-items:center;
  }
  h1 {
    text-align:center;
    margin-bottom:20px;
    color:#60a5fa;
  }
  .lang-toggle {
    text-align:center;
    margin-bottom:20px;
  }
  .lang-toggle button {
    background:#2563eb;
    color:#fff;
    border:none;
    padding:8px 14px;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
    font-size:1rem;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .lang-toggle img {
    height:16px;
    vertical-align:middle;
  }
  .grid {
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap:20px;
    max-width:1000px;
    width:100%;
    justify-items:center;
  }
  .site {
    background:#1f2937;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 4px 8px rgba(0,0,0,0.3);
    width:250px;
  }
  .site img {
    width:100%;
    height:140px;
    object-fit:cover;
  }
  .site-body {
    padding:12px;
  }
  .site-body strong {
    font-size:1.1rem;
    color:#facc15;
  }
  .crew {
    margin-top:8px;
    font-size:0.9rem;
    color:#93c5fd;
  }
  .marquee {
    width:100%;
    margin-top:20px;
    overflow:hidden;
    white-space:nowrap;
  }
  .marquee span {
    display:inline-block;
    padding-left:100%;
    animation: scroll 15s linear infinite;
  }
  @keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }
</style>
</head>
<body>
<h1>üìã –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –¥–µ–Ω—å</h1>
<div class="lang-toggle">
  <button id="langBtn" onclick="toggleLang()">
    <img id="langFlag" src="images/fr.png" alt="FR">
    <span id="langText">Fran√ßais</span>
  </button>
</div>
<div class="grid" id="planning"></div>

<div class="marquee"><span id="marqueeText">‚ö†Ô∏è –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ ‚ö†Ô∏è</span></div>

<script>
let currentLang = "uk"; // ‚úÖ ukrainien par d√©faut

function afficherPlanning() {
  fetch("planning.json?ts=" + Date.now())
    .then(r => r.json())
    .then(data => {
      const zone = document.getElementById("planning");
      zone.innerHTML = "";
      data.forEach(site => {
        const card = document.createElement("div");
        card.className = "site";
        card.innerHTML = `
          <img src="${site.photo || 'images/placeholder.jpg'}" alt="${site.title[currentLang]}">
          <div class="site-body">
            <strong>${site.title[currentLang]}</strong><br>
            üìç ${site.address[currentLang]}<br>
            üïó ${site.start}<br>
            <div class="crew">
              ${site.crew.map(c => (c.type==="ouvrier"?"üë∑ ":"üõ†Ô∏è ")+c.name).join(" / ")}
            </div>
          </div>
        `;
        zone.appendChild(card);
      });
    })
    .catch(err => {
      document.getElementById("planning").innerHTML = "<p style='color:red'>Erreur de lecture du planning.json</p>";
      console.error("Erreur JSON :", err);
    });
}

function toggleLang() {
  if (currentLang === "uk") {
    currentLang = "fr";
    document.getElementById("langFlag").src = "images/ua.png";
    document.getElementById("langFlag").alt = "UA";
    document.getElementById("langText").textContent = "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞";
    document.getElementById("marqueeText").textContent = "‚ö†Ô∏è N'oubliez pas de v√©rifier mat√©riel et outils ‚ö†Ô∏è";
  } else {
    currentLang = "uk";
    document.getElementById("langFlag").src = "images/fr.png";
    document.getElementById("langFlag").alt = "FR";
    document.getElementById("langText").textContent = "Fran√ßais";
    document.getElementById("marqueeText").textContent = "‚ö†Ô∏è –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ ‚ö†Ô∏è";
  }
  afficherPlanning();
}

// Premier affichage
afficherPlanning();

// Rafra√Æchit toutes les minutes
setInterval(afficherPlanning, 60000);
</script>
</body>
</html>